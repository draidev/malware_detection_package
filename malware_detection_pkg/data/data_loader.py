import os
  
def set_path(default_root_path=None):
    if default_root_path == None:
        default_root_path = "/lockard_ai/works/malware_detection/"

    os.chdir(default_root_path)
    return default_root_path


def get_full_path(name, default_root_path=None):
    try:
        if default_root_path is None:
            default_root_path = "/lockard_ai/works/malware_detection/"

        file_list = list()
        dir_list = list()
        for root, dirs, files in os.walk(default_root_path):
            for f in files:
                if name in f:
                    file_full_path = os.path.join(root, f)
                    print("file path :", file_full_path)
                    file_list.append(file_full_path)
                     
            for d in dirs:
                if name in d:
                    dir_full_path = os.path.join(root, d) 
                    print("dir path :", dir_full_path)
                    dir_list.append(dir_full_path)
        
        if not file_list:
            return dir_list
       
        if not dir_list:
            return file_list
       
        full_list = file_list + dir_list
        return full_list

    except Exception as e:
        print("Can't get full path error :", e)


def load_dataset(default_root_path, file_name):
    possible_separators = [',', ';', '\t', '|', ':', ' ']
    for root, dir, file in os.walk(default_root_path):
        for f in file:
            if file_name in f:
                dataset_path = os.path.join(root, f)
                print("dataset path :", dataset_path)

    for separator in possible_separators:
        try:
            df = pd.read_csv(dataset_path, sep=separator)
            return df
        except pd.errors.ParserError:
            continue

    raise ValueError("Unable to determine the separator for the CSV file")